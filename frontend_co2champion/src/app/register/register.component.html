<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">

      <h2 class="text-center mb-4">Create an Account</h2>
      <form
        [formGroup]="registerFormGroup"
        (ngSubmit)="onRegister()"
        novalidate
        class="needs-validation"
        [class.was-validated]="submitted"
      >

        <!-- ======================================
             Company Information Section
        ======================================= -->
        <h4 class="mb-3">Company Information</h4>

        <!-- Company Name -->
        <div class="mb-3">
          <label for="company_name" class="form-label">Company Name*</label>
          <input
            type="text"
            id="company_name"
            class="form-control"
            formControlName="company_name"
            placeholder="Enter your company name"
            (input)="generateUsername()"
          />
          <!-- Fehlermeldungen -->
          <div
            *ngIf="isFieldInvalid('company_name')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('company_name') }}
          </div>
        </div>

        <!-- Company UID -->
        <div class="mb-3">
          <label for="company_uid" class="form-label">Company UID*</label>
          <input
            type="text"
            id="company_uid"
            class="form-control"
            formControlName="company_uid"
            placeholder="Enter company UID (uppercase letters & digits)"
          />
          <div
            *ngIf="isFieldInvalid('company_uid')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('company_uid') }}
          </div>
        </div>

        <!-- Number of Employees -->
        <div class="mb-3">
          <label for="employee_size" class="form-label">Number of Employees*</label>
          <input
            type="number"
            id="employee_size"
            class="form-control"
            formControlName="employee_size"
            placeholder="Enter number of employees (min. 4)"
          />
          <div
            *ngIf="isFieldInvalid('employee_size')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('employee_size') }}
          </div>
        </div>

        <!-- Total Annual Income -->
        <div class="mb-3">
          <label for="total_income" class="form-label"
            >Total Annual Income (€)*</label
          >
          <input
            type="number"
            id="total_income"
            class="form-control"
            formControlName="total_income"
            placeholder="Enter annual income (min. 5000)"
          />
          <div
            *ngIf="isFieldInvalid('total_income')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('total_income') }}
          </div>
        </div>

        <!-- ======================================
             Representative Information Section
        ======================================= -->
        <h4 class="mb-3">Representative Information</h4>

        <!-- First Name -->
        <div class="mb-3">
          <label for="rep_first_name" class="form-label">First Name*</label>
          <input
            type="text"
            id="rep_first_name"
            class="form-control"
            formControlName="rep_first_name"
            placeholder="Enter representative's first name"
          />
          <div
            *ngIf="isFieldInvalid('rep_first_name')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('rep_first_name') }}
          </div>
        </div>

        <!-- Last Name -->
        <div class="mb-3">
          <label for="rep_last_name" class="form-label">Last Name*</label>
          <input
            type="text"
            id="rep_last_name"
            class="form-control"
            formControlName="rep_last_name"
            placeholder="Enter representative's last name"
          />
          <div
            *ngIf="isFieldInvalid('rep_last_name')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('rep_last_name') }}
          </div>
        </div>

        <!-- Username (autogenerated, read-only) -->
        <div class="mb-3">
          <label for="username" class="form-label">Username*</label>
          <input
            type="text"
            id="username"
            class="form-control"
            formControlName="username"
            [readonly]="true"
          />
          <!-- Info: no direct validation required because it’s auto-generated -->
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email*</label>
          <input
            type="email"
            id="email"
            class="form-control"
            formControlName="email"
            placeholder="name@domain.com"
          />
          <div
            *ngIf="isFieldInvalid('email')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('email') }}
          </div>
        </div>

        <!-- ======================================
             Security (Password) Section
        ======================================= -->
        <h4 class="mb-3">Security</h4>

        <!-- Password -->
        <div class="mb-3">
          <label for="password" class="form-label">Password*</label>
          <input
            type="password"
            id="password"
            class="form-control"
            formControlName="password"
            placeholder="At least 8 chars, 1 uppercase, 1 lowercase, 1 digit, 1 special char"
          />
          <div
            *ngIf="isFieldInvalid('password')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('password') }}
          </div>
        </div>

        <!-- Confirm Password -->
        <div class="mb-3">
          <label for="confirm_password" class="form-label"
            >Confirm Password*</label
          >
          <input
            type="password"
            id="confirm_password"
            class="form-control"
            formControlName="confirm_password"
            placeholder="Re-enter your password"
          />
          <div
            *ngIf="isFieldInvalid('confirm_password')"
            class="text-danger small mt-1"
          >
            {{ getErrorMessage('confirm_password') }}
          </div>
        </div>

        <!-- Submit Button & Back to Login -->
        <div class="d-grid gap-2 mt-4">
          <button type="submit" class="btn btn-primary">Register</button>
          <button
            type="button"
            class="btn btn-secondary"
            (click)="goToLogin()"
          >
            Back to Login
          </button>
        </div>

      </form>
    </div>
  </div>
</div>
